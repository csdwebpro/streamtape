<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Streamtape Pro Uploader</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <style>
    .drop-zone-active { @apply border-blue-500 bg-blue-50 dark:bg-blue-900/20; }
    .progress { transition: width 0.3s ease; }
    .encrypted { display: none; }
    .folder-tree { max-height: 300px; overflow-y: auto; }
  </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 min-h-screen transition-colors">

<div x-data="streamtapePro()" x-init="init()" class="max-w-5xl mx-auto p-6">

  <!-- Header -->
  <header class="flex justify-between items-center mb-8">
    <h1 class="text-3xl font-bold flex items-center gap-2">
      <i class="fas fa-video text-blue-600"></i> Streamtape Pro
    </h1>
    <div class="flex items-center gap-4">
      <button @click="darkMode = !darkMode" class="p-2 rounded-lg bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 transition">
        <i x-show="!darkMode" class="fas fa-moon"></i>
        <i x-show="darkMode" class="fas fa-sun text-yellow-400"></i>
      </button>
      <span class="text-sm text-gray-500" x-text="accountInfo?.result?.email || 'Authenticating...'"></span>
    </div>
  </header>

  <!-- Tabs -->
  <div class="flex border-b border-gray-300 dark:border-gray-700 mb-6">
    <button @click="tab = 'local'" :class="tab === 'local' ? 'border-b-2 border-blue-600 text-blue-600' : 'text-gray-500'" class="px-4 py-2 font-medium">Local Files</button>
    <button @click="tab = 'remote'" :class="tab === 'remote' ? 'border-b-2 border-blue-600 text-blue-600' : 'text-gray-500'" class="px-4 py-2 font-medium">Remote URL</button>
    <button @click="tab = 'folders'" :class="tab === 'folders' ? 'border-b-2 border-blue-600 text-blue-600' : 'text-gray-500'" class="px-4 py-2 font-medium">Folders</button>
  </div>

  <!-- === LOCAL UPLOAD TAB === -->
  <div x-show="tab === 'local'">
    <!-- Upload Zone -->
    <div
      @dragover.prevent="dragOver = true"
      @dragleave.prevent="dragOver = false"
      @drop.prevent="handleDrop($event)"
      :class="dragOver ? 'drop-zone-active' : ''"
      class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-12 text-center cursor-pointer transition-all duration-300 hover:border-blue-400 dark:hover:border-blue-500"
      @click="$refs.fileInput.click()"
    >
      <input x-ref="fileInput" type="file" multiple hidden @change="handleFiles($event.target.files)" accept="video/*" />
      <i class="fas fa-cloud-upload-alt text-6xl text-gray-400 mb-4"></i>
      <p class="text-xl font-medium">Drop videos or click to upload</p>
      <p class="text-sm text-gray-500 dark:text-gray-400 mt-2">Max 10GB per file</p>
    </div>

    <!-- File List -->
    <div class="mt-8 space-y-4" x-show="files.length > 0">
      <template x-for="(file, index) in files" :key="index">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 flex items-center gap-4 border border-gray-200 dark:border-gray-700">
          <div class="flex-shrink-0">
            <video :src="file.preview" class="w-16 h-16 object-cover rounded-lg" controls></video>
          </div>
          <div class="flex-grow">
            <p class="font-medium truncate" :title="file.name" x-text="file.name"></p>
            <p class="text-sm text-gray-500 dark:text-gray-400" x-text="formatBytes(file.size)"></p>
            <div class="mt-2 bg-gray-200 dark:bg-gray-700 rounded-full h-2 overflow-hidden">
              <div class="h-full bg-gradient-to-r from-blue-500 to-blue-600 progress" :style="{ width: file.progress + '%' }"></div>
            </div>
            <p class="text-xs text-gray-500 mt-1" x-text="file.status"></p>
            <template x-if="file.streamUrl">
              <a :href="file.streamUrl" target="_blank" class="mt-2 inline-flex items-center gap-1 text-blue-600 hover:text-blue-700 text-sm">
                <i class="fas fa-play"></i> Watch
              </a>
            </template>
          </div>
          <div class="flex gap-2">
            <button @click="removeFile(index)" class="text-red-600 hover:text-red-700 p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/20 transition">
              <i class="fas fa-trash"></i>
            </button>
          </div>
        </div>
      </template>
    </div>

    <!-- Folder Selector -->
    <div class="mt-6" x-show="files.length > 0 && folders.length > 0">
      <label class="block text-sm font-medium mb-2">Upload to Folder:</label>
      <select x-model="selectedFolderId" class="w-full p-2 border rounded-lg dark:bg-gray-800 dark:border-gray-600">
        <option value="">Root</option>
        <template x-for="folder in folders" :key="folder.id">
          <option :value="folder.id" x-text="folder.name"></option>
        </template>
      </select>
    </div>

    <!-- Upload Button -->
    <div class="mt-8 text-center" x-show="files.length > 0 && !uploading">
      <button @click="uploadFiles()" class="px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow-lg hover:shadow-xl transition transform hover:-translate-y-0.5">
        <i class="fas fa-upload mr-2"></i> Upload All
      </button>
    </div>
  </div>

  <!-- === REMOTE URL TAB === -->
  <div x-show="tab === 'remote'" class="space-y-6">
    <div>
      <label class="block text-sm font-medium mb-2">Video URL</label>
      <input type="url" x-model="remoteUrl" placeholder="https://example.com/video.mp4" class="w-full p-3 border rounded-lg dark:bg-gray-800 dark:border-gray-600" />
    </div>
    <div x-show="folders.length > 0">
      <label class="block text-sm font-medium mb-2">Folder</label>
      <select x-model="remoteFolderId" class="w-full p-2 border rounded-lg dark:bg-gray-800 dark:border-gray-600">
        <option value="">Root</option>
        <template x-for="folder in folders" :key="folder.id">
          <option :value="folder.id" x-text="folder.name"></option>
        </template>
      </select>
    </div>
    <button @click="addRemoteUpload()" :disabled="!remoteUrl || remoteUploading" class="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg">
      <i class="fas fa-link mr-2"></i> Add Remote Upload
    </button>

    <!-- Remote Queue -->
    <div class="mt-6 space-y-3" x-show="remoteQueue.length > 0">
      <template x-for="item in remoteQueue" :key="item.id">
        <div class="bg-white dark:bg-gray-800 p-3 rounded-lg border dark:border-gray-700">
          <p class="text-sm font-medium truncate" x-text="item.url"></p>
          <p class="text-xs text-gray-500" x-text="item.status"></p>
          <template x-if="item.result">
            <a :href="item.result.url" target="_blank" class="text-blue-600 text-xs">Watch</a>
          </template>
        </div>
      </template>
    </div>
  </div>

  <!-- === FOLDERS TAB === -->
  <div x-show="tab === 'folders'" class="space-y-6">
    <div class="flex justify-between items-center">
      <h3 class="text-lg font-semibold">Your Folders</h3>
      <button @click="showCreateFolder = true" class="text-blue-600 hover:text-blue-700">
        <i class="fas fa-plus"></i> New Folder
      </button>
    </div>

    <!-- Create Folder -->
    <div x-show="showCreateFolder" class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg">
      <input x-model="newFolderName" placeholder="Folder name" class="w-full p-2 border rounded dark:bg-gray-700 dark:border-gray-600 mb-2" />
      <div class="flex gap-2">
        <button @click="createFolder()" class="px-4 py-1 bg-blue-600 text-white rounded">Create</button>
        <button @click="showCreateFolder = false" class="px-4 py-1 bg-gray-300 dark:bg-gray-600 rounded">Cancel</button>
      </div>
    </div>

    <!-- Folder Tree -->
    <div class="folder-tree bg-white dark:bg-gray-800 rounded-lg border dark:border-gray-700 p-4">
      <template x-for="folder in folders" :key="folder.id">
        <div class="flex justify-between items-center py-2 border-b dark:border-gray-700">
          <span class="flex items-center gap-2">
            <i class="fas fa-folder text-yellow-600"></i>
            <span x-text="folder.name"></span>
          </span>
          <button @click="deleteFolder(folder.id)" class="text-red-600 hover:text-red-700 text-sm">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </template>
      <p class="text-sm text-gray-500 mt-4" x-show="folders.length === 0">No folders yet.</p>
    </div>
  </div>

  <!-- Global States -->
  <div class="mt-8 text-center" x-show="uploading || remoteUploading">
    <div class="inline-flex items-center gap-3">
      <i class="fas fa-spinner animate-spin text-blue-600 text-xl"></i>
      <span class="font-medium" x-text="uploading ? 'Uploading files...' : 'Adding remote upload...'"></span>
    </div>
  </div>

  <div class="mt-8 p-4 bg-green-100 dark:bg-green-900/30 border border-green-400 dark:border-green-700 rounded-lg text-green-800 dark:text-green-200" x-show="uploadComplete">
    <i class="fas fa-check-circle mr-2"></i> All operations completed!
  </div>

  <div class="mt-8 p-4 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-700 rounded-lg text-red-800 dark:text-red-200" x-show="errorMsg" x-text="errorMsg" x-transition></div>

  <!-- Hidden Credentials -->
  <div class="encrypted">
    <span>NjU2MDhjMzRlNjIzZGE1ZWNkODQ=</span> <!-- base64: 59608c34e623da5ecd84 -->
    <span>YmVQMm9kQm9reVVQMURC</span>       <!-- base64: beP2odBokyUP1D2 -->
  </div>
</div>

<script>
function streamtapePro() {
  return {
    tab: 'local',
    files: [],
    originalFiles: [],
    dragOver: false,
    uploading: false,
    uploadComplete: false,
    darkMode: false,
    apiKey: null,
    accountInfo: null,
    errorMsg: '',
    folders: [],
    selectedFolderId: '',
    remoteUrl: '',
    remoteFolderId: '',
    remoteUploading: false,
    remoteQueue: [],
    showCreateFolder: false,
    newFolderName: '',

    init() {
      this.darkMode = localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches);
      this.updateDarkMode();
      this.$watch('darkMode', () => this.updateDarkMode());
      this.authenticate();
      this.loadFolders();
    },

    updateDarkMode() {
      document.documentElement.classList.toggle('dark', this.darkMode);
      localStorage.theme = this.darkMode ? 'dark' : 'light';
    },

    authenticate() {
      const login = atob(document.querySelector('.encrypted span:nth-child(1)').textContent);
      const pass = atob(document.querySelector('.encrypted span:nth-child(2)').textContent);
      this.apiKey = this.md5(login + ':' + pass);
      this.fetchAccountInfo(login);
    },

    async fetchAccountInfo(login) {
      try {
        const res = await fetch(`https://api.streamtape.com/account/info?login=${login}&key=${this.apiKey}`);
        const data = await res.json();
        if (data.status === 200) this.accountInfo = data;
        else this.errorMsg = 'Auth failed: ' + data.msg;
      } catch (err) {
        this.errorMsg = 'Network error: ' + err.message;
      }
    },

    async loadFolders() {
      const login = atob(document.querySelector('.encrypted span:nth-child(1)').textContent);
      try {
        const res = await fetch(`https://api.streamtape.com/file/listfolder?login=${login}&key=${this.apiKey}&folder=`);
        const data = await res.json();
        if (data.status === 200) this.folders = data.result.folders || [];
      } catch (err) {
        console.error('Folder load failed', err);
      }
    },

    async createFolder() {
      if (!this.newFolderName.trim()) return;
      const login = atob(document.querySelector('.encrypted span:nth-child(1)').textContent);
      try {
        const res = await fetch(`https://api.streamtape.com/file/createfolder?login=${login}&key=${this.apiKey}&name=${encodeURIComponent(this.newFolderName)}`);
        const data = await res.json();
        if (data.status === 200) {
          this.loadFolders();
          this.newFolderName = '';
          this.showCreateFolder = false;
        } else {
          this.errorMsg = data.msg;
        }
      } catch (err) {
        this.errorMsg = err.message;
      }
    },

    async deleteFolder(id) {
      if (!confirm('Delete this folder?')) return;
      const login = atob(document.querySelector('.encrypted span:nth-child(1)').textContent);
      await fetch(`https://api.streamtape.com/file/deletefolder?login=${login}&key=${this.apiKey}&id=${id}`);
      this.loadFolders();
    },

    handleFiles(fileList) {
      [...fileList].forEach(file => this.addFile(file));
    },

    handleDrop(e) {
      this.dragOver = false;
      this.handleFiles(e.dataTransfer.files);
    },

    addFile(file) {
      if (file.size > 10 * 1024 * 1024 * 1024) {
        this.errorMsg = 'File too large (max 10GB)';
        return;
      }
      const reader = new FileReader();
      reader.onload = e => {
        this.files.push({
          name: file.name,
          size: file.size,
          preview: e.target.result,
          progress: 0,
          status: 'Ready'
        });
      };
      reader.readAsDataURL(file);
      this.originalFiles.push(file);
    },

    removeFile(i) {
      this.files.splice(i, 1);
      this.originalFiles.splice(i, 1);
    },

    formatBytes(bytes) {
      const units = ['B', 'KB', 'MB', 'GB'];
      let i = 0;
      while (bytes >= 1024 && i < units.length - 1) { bytes /= 1024; i++; }
      return `${bytes.toFixed(1)} ${units[i]}`;
    },

    async uploadFiles() {
      this.uploading = true;
      this.errorMsg = '';
      const login = atob(document.querySelector('.encrypted span:nth-child(1)').textContent);

      for (let i = 0; i < this.originalFiles.length; i++) {
        const file = this.originalFiles[i];
        const fileObj = this.files[i];
        fileObj.status = 'Getting ticket...';

        try {
          const ticketRes = await fetch(`https://api.streamtape.com/upload/get_ticket?login=${login}&key=${this.apiKey}`);
          const ticket = await ticketRes.json();
          if (ticket.status !== 200) throw new Error(ticket.msg);

          const uploadUrl = `https://tapecontent.net/${ticket.result.ticket}`;
          if (this.selectedFolderId) uploadUrl += `?folder=${this.selectedFolderId}`;

          fileObj.status = 'Uploading...';
          await this.uploadWithProgress(uploadUrl, file, fileObj);
          fileObj.status = 'Complete';
        } catch (err) {
          fileObj.status = 'Failed';
          this.errorMsg = `Upload failed: ${err.message}`;
        }
      }

      this.uploading = false;
      this.uploadComplete = true;
      setTimeout(() => this.uploadComplete = false, 5000);
    },

    uploadWithProgress(url, file, fileObj) {
      return new Promise((resolve, reject) => {
        const xhr = new XMLHttpRequest();
        const form = new FormData();
        form.append('file1', file);

        xhr.upload.onprogress = e => {
          if (e.lengthComputable) {
            fileObj.progress = Math.round((e.loaded / e.total) * 100);
          }
        };

        xhr.onload = () => {
          const match = xhr.responseText.match(/\{.*\}/);
          if (match) {
            const data = JSON.parse(match[0]);
            if (data.status === 200) {
              fileObj.streamUrl = data.result?.url || `https://streamtape.com/e/${data.result?.name}`;
              resolve();
            } else reject(new Error(data.msg));
          } else reject(new Error('Invalid response'));
        };

        xhr.onerror = () => reject(new Error('Network error'));
        xhr.open('POST', url);
        xhr.send(form);
      });
    },

    async addRemoteUpload() {
      if (!this.remoteUrl) return;
      this.remoteUploading = true;
      const login = atob(document.querySelector('.encrypted span:nth-child(1)').textContent);
      const id = Date.now();
      this.remoteQueue.push({ id, url: this.remoteUrl, status: 'Adding...' });

      try {
        const folderParam = this.remoteFolderId ? `&folder=${this.remoteFolderId}` : '';
        const res = await fetch(`https://api.streamtape.com/remotedl/add?login=${login}&key=${this.apiKey}&url=${encodeURIComponent(this.remoteUrl)}${folderParam}`);
        const data = await res.json();
        const item = this.remoteQueue.find(x => x.id === id);
        if (data.status === 200) {
          item.status = 'Added to queue';
          item.result = data.result;
        } else {
          item.status = 'Failed: ' + data.msg;
        }
      } catch (err) {
        this.remoteQueue.find(x => x.id === id).status = 'Error: ' + err.message;
      }

      this.remoteUploading = false;
      this.remoteUrl = '';
    },

    // MD5 Hash (same as before)
    md5(message) {
      // ... [Full MD5 implementation from previous version - unchanged]
      // (Omitted for brevity - copy from previous response)
      // It must be included here in full.
      function rotateLeft(lValue, iShiftBits) { return (lValue << iShiftBits) | (lValue >>> (32 - iShiftBits)); }
      function addUnsigned(lX, lY) {
        const lX4 = (lX & 0x3FFFFFFF), lY4 = (lY & 0x3FFFFFFF), lX8 = (lX & 0x80000000), lY8 = (lY & 0x80000000);
        const lResult = (lX4 + lY4);
        if (lX8 & lY8) return (lResult ^ 0x80000000 ^ (lResult & 0x80000000));
        if (lX8 | lY8) return lResult & 0x40000000 ? (lResult ^ 0xC0000000) : (lResult ^ 0x40000000);
        return lResult;
      }
      function F(x,y,z){return (x&y)|((~x)&z);} function G(x,y,z){return (x&z)|(y&(~z));} function H(x,y,z){return x^y^z;} function I(x,y,z){return y^(x|(~z));}
      function FF(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(F(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b);}
      function GG(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(G(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b);}
      function HH(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(H(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b);}
      function II(a,b,c,d,x,s,ac){a=addUnsigned(a,addUnsigned(addUnsigned(I(b,c,d),x),ac));return addUnsigned(rotateLeft(a,s),b);}
      function ConvertToWordArray(string){let lWordCount;const lMessageLength=string.length;const lNumberOfWords_temp1=lMessageLength+8;const lNumberOfWords_temp2=(lNumberOfWords_temp1-(lNumberOfWords_temp1%64))/64;const lNumberOfWords=(lNumberOfWords_temp2+1)*16;const lWordArray=Array(lNumberOfWords-1);let lBytePosition=0;let lByteCount=0;while(lByteCount<lMessageLength){lWordArray[lBytePosition>>5]|=(string.charCodeAt(lByteCount)&0xFF)<<(lByteCount%4*8);lByteCount++;lBytePosition+=8;}lWordArray[lBytePosition>>5]|=0x80<<(lBytePosition%4*8);lWordArray[lNumberOfWords-2]=lMessageLength<<3;lWordArray[lNumberOfWords-1]=lMessageLength>>>29;return lWordArray;}
      function WordToHex(lValue){let WordToHexValue="",WordToHexValue_temp="",lByte,lCount;for(lCount=0;lCount<=3;lCount++){lByte=(lValue>>>(lCount*8))&255;WordToHexValue_temp="0"+lByte.toString(16);WordToHexValue=WordToHexValue+WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2);}return WordToHexValue;}
      let x=[],k,AA,BB,CC,DD,a,b,c,d,S11=7,S12=12,S13=17,S14=22,S21=5,S22=9,S23=14,S24=20,S31=4,S32=11,S33=16,S34=23,S41=6,S42=10,S43=15,S44=21;
      x=ConvertToWordArray(message);a=0x67452301;b=0xEFCDAB89;c=0x98BADCFE;d=0x10325476;
      for(k=0;k<x.length;k+=16){AA=a;BB=b;CC=c;DD=d;a=FF(a,b,c,d,x[k+0],S11,0xD76AA478);d=FF(d,a,b,c,x[k+1],S12,0xE8C7B756);c=FF(c,d,a,b,x[k+2],S13,0x242070DB);b=FF(b,c,d,a,x[k+3],S14,0xC1BDCEEE);a=FF(a,b,c,d,x[k+4],S11,0xF57C0FAF);d=FF(d,a,b,c,x[k+5],S12,0x4787C62A);c=FF(c,d,a,b,x[k+6],S13,0xA8304613);b=FF(b,c,d,a,x[k+7],S14,0xFD469501);a=FF(a,b,c,d,x[k+8],S11,0x698098D8);d=FF(d,a,b,c,x[k+9],S12,0x8B44F7AF);c=FF(c,d,a,b,x[k+10],S13,0xFFFF5BB1);b=FF(b,c,d,a,x[k+11],S14,0x895CD7BE);a=FF(a,b,c,d,x[k+12],S11,0x6B901122);d=FF(d,a,b,c,x[k+13],S12,0xFD987193);c=FF(c,d,a,b,x[k+14],S13,0xA679438E);b=FF(b,c,d,a,x[k+15],S14,0x49B40821);a=GG(a,b,c,d,x[k+1],S21,0xF61E2562);d=GG(d,a,b,c,x[k+6],S22,0xC040B340);c=GG(c,d,a,b,x[k+11],S23,0x265E5A51);b=GG(b,c,d,a,x[k+0],S24,0xE9B6C7AA);a=GG(a,b,c,d,x[k+5],S21,0xD62F105D);d=GG(d,a,b,c,x[k+10],S22,0x2441453);c=GG(c,d,a,b,x[k+15],S23,0xD8A1E681);b=GG(b,c,d,a,x[k+4],S24,0xE7D3FBC8);a=GG(a,b,c,d,x[k+9],S21,0x21E1CDE6);d=GG(d,a,b,c,x[k+14],S22,0xC33707D6);c=GG(c,d,a,b,x[k+3],S23,0xF4D50D87);b=GG(b,c,d,a,x[k+8],S24,0x455A14ED);a=GG(a,b,c,d,x[k+13],S21,0xA9E3E905);d=GG(d,a,b,c,x[k+2],S22,0xFCEFA3F8);c=GG(c,d,a,b,x[k+7],S23,0x676F02D9);b=GG(b,c,d,a,x[k+12],S24,0x8D2A4C8A);a=HH(a,b,c,d,x[k+5],S31,0xFFFA3942);d=HH(d,a,b,c,x[k+8],S32,0x8771F681);c=HH(c,d,a,b,x[k+11],S33,0x6D9D6122);b=HH(b,c,d,a,x[k+14],S34,0xFDE5380C);a=HH(a,b,c,d,x[k+1],S31,0xA4BEEA44);d=HH(d,a,b,c,x[k+4],S32,0x4BDECFA9);c=HH(c,d,a,b,x[k+7],S33,0xF6BB4B60);b=HH(b,c,d,a,x[k+10],S34,0xBEBFBC70);a=HH(a,b,c,d,x[k+13],S31,0x289B7EC6);d=HH(d,a,b,c,x[k+0],S32,0xEAA127FA);c=HH(c,d,a,b,x[k+3],S33,0xD4EF3085);b=HH(b,c,d,a,x[k+6],S34,0x4881D05);a=HH(a,b,c,d,x[k+9],S31,0xD9D4D039);d=HH(d,a,b,c,x[k+12],S32,0xE6DB99E5);c=HH(c,d,a,b,x[k+15],S33,0x1FA27CF8);b=HH(b,c,d,a,x[k+2],S34,0xC4AC5665);a=II(a,b,c,d,x[k+0],S41,0xF4292244);d=II(d,a,b,c,x[k+7],S42,0x432AFF97);c=II(c,d,a,b,x[k+14],S43,0xAB9423A7);b=II(b,c,d,a,x[k+5],S44,0xFC93A039);a=II(a,b,c,d,x[k+12],S41,0x655B59C3);d=II(d,a,b,c,x[k+3],S42,0x8F0CCC92);c=II(c,d,a,b,x[k+10],S43,0xFFEFF47D);b=II(b,c,d,a,x[k+1],S44,0x85845DD1);a=II(a,b,c,d,x[k+8],S41,0x6FA87E4F);d=II(d,a,b,c,x[k+15],S42,0xFE2CE6E0);c=II(c,d,a,b,x[k+6],S43,0xA3014314);b=II(b,c,d,a,x[k+13],S44,0x4E0811A1);a=II(a,b,c,d,x[k+4],S41,0xF7537E82);d=II(d,a,b,c,x[k+11],S42,0xBD3AF235);c=II(c,d,a,b,x[k+2],S43,0x2AD7D2BB);b=II(b,c,d,a,x[k+9],S44,0xEB86D391);a=addUnsigned(a,AA);b=addUnsigned(b,BB);c=addUnsigned(c,CC);d=addUnsigned(d,DD);}
      return (WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d)).toLowerCase();
    }
  };
}
</script>

</body>
</html>
